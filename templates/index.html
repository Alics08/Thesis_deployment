<script>
  const msgerForm = document.querySelector(".msger-inputarea");
  const msgerInput = document.querySelector(".msger-input");
  const msgerChat = document.querySelector(".msger-chat");

  const BOT_IMG = "https://scontent.fcgy2-2.fna.fbcdn.net/v/t1.15752-9/440102351_1566729290843198_6313492771902305599_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=9f807c&_nc_eui2=AeFbdQ2ARE1-a6onSFNNjOZiF_ifW4g9YzgX-J9biD1jOMZ902Zyqmhsp1DYgnP1O2vyB4BUnrUpVbSwL9HsTBkb&_nc_ohc=_TQF2kZFO9oQ7kNvgGldJjS&_nc_zt=23&_nc_ht=scontent.fcgy2-2.fna&_nc_gid=AQFCbvZIXO5tVBQgt4Bq44D&oh=03_Q7cD1QF0lp1pFVm-p3M2_FknuV6fAyeXpuZEec3gCSFvO7wKZA&oe=67304368";
  const PERSON_IMG = "https://th.bing.com/th/id/OIP.S5yvyPY2sRDqgIHMtCx0DwHaHa?rs=1&pid=ImgDetMain";
  const BOT_NAME = "ALiCS";
  const PERSON_NAME = "You";

  msgerForm.addEventListener("submit", event => {
    event.preventDefault();  // Prevents the default form submission
    const msgText = msgerInput.value.trim(); // Trim whitespace
    if (!msgText) return; // Do nothing if input is empty

    appendMessage(PERSON_NAME, PERSON_IMG, "right", msgText);
    msgerInput.value = ""; // Clear input field
    botResponse(msgText); // Pass msgText to botResponse
  });

  function appendMessage(name, img, side, text) {
    const msgHTML = `
      <div class="msg ${side}-msg">
        <div class="msg-img" style="background-image: url(${img})"></div>
        <div class="msg-bubble">
          <div class="msg-info">
            <div class="msg-info-name">${name}</div>
            <div class="msg-info-time">${formatDate(new Date())}</div>
          </div>
          <div class="msg-text">${text}</div>
        </div>
      </div>`;
    
    msgerChat.insertAdjacentHTML("beforeend", msgHTML);
    msgerChat.scrollTop = msgerChat.scrollHeight; // Scroll to the bottom
  }

  function botResponse(userText) {
    const url = `https://inquirealics.onrender.com/get?msg=${userText}`; // Update this line
    fetch(url)
      .then(response => response.json())
      .then(data => {
        // Process the data and display the response
        const msgText = data; // Adjust based on your response structure
        appendMessage(BOT_NAME, BOT_IMG, "left", msgText);
      })
      .catch(error => {
        console.error("Error:", error);
        appendMessage(BOT_NAME, BOT_IMG, "left", "Sorry, I could not connect to the server. Please try again later.");
      });
  }

  function formatDate(date) {
    const h = "0" + date.getHours();
    const m = "0" + date.getMinutes();
    return `${h.slice(-2)}:${m.slice(-2)}`;
  }
</script>
